<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>ุงูุนุฒ ููุฅุฏุงุฑุฉ ุงููุงููุฉ - ูุฏูุฑ ุงููุฎุงุทุฑ</title>
  <meta name="theme-color" content="#0f1115">
  <link rel="manifest" href="./manifest.json">
  <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png">
  <link rel="apple-touch-icon" href="/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="stylesheet" href="./styles.css">
</head>
<body>
  <header class="topbar">
    <div class="brand"><span class="logo"></span><b>ุงูุนุฒ ููุฅุฏุงุฑุฉ ุงููุงููุฉ</b><small>ูุฏูุฑ ูุฎุงุทุฑ ูููุชุฏุงูู ุงููุญุชุฑู</small></div>
    <div class="actions">
      <button id="btnInstall" class="ghost" hidden>ุชุซุจูุช ุงูุชุทุจูู</button>
      <a class="ghost" href="https://instagram.com/ezaldeen.aldulami" target="_blank">@ezaldeen.aldulami</a>
    </div>
  </header>

  <nav class="tabs">
    <button class="tab-btn active" data-tab="risk">ูุฏูุฑ ุงููุฎุงุทุฑ</button>
    <button class="tab-btn" data-tab="journal">ุณุฌู ุงูุตููุงุช</button>
    <button class="tab-btn" data-tab="stats">ุงูุฅุญุตุงุฆูุงุช</button>
    <button class="tab-btn" data-tab="backup">ูุณุฎ ุงุญุชูุงุทู</button>
  </nav>

  <main>
    <!-- Risk Manager -->
    <section id="tab-risk" class="tab active">
      <div class="card">
        <h2>โ๏ธ ุญุณุงุจ ุญุฌู ุงูุนูุฏ ููู ุฃุฒูุงุฌ ุงูููุฑูุณ</h2>
        <p class="muted">ุฃุฏุฎู ุงูุจูุงูุงุช ุจุฏูุฉ. ุงูุญุณุงุจ ุจุงูุฏููุงุฑ USD. ููุฃุฒูุงุฌ ุงููุชูุงุทุนุฉ ุนุฏูู <b>ูููุฉ ุงูููุทุฉ/ููุช</b> ูุฏูููุง ุญุณุจ ูุณูุทู.</p>
        <div class="grid">
          <label>ุฒูุฌ ุงูุนููุฉ
            <input list="pairs" id="pair" placeholder="EURUSD / USDJPY / XAUUSD ...">
            <datalist id="pairs">
              <option value="EURUSD"></option><option value="GBPUSD"></option>
              <option value="USDJPY"></option><option value="XAUUSD"></option>
              <option value="US30"></option>
            </datalist>
          </label>
          <label>ุงูุณุนุฑ ุงูุญุงูู
            <input type="number" step="0.00001" id="price" placeholder="1.08500 ุฃู 157.25">
          </label>
          <label>ุฑุตูุฏ ุงูุญุณุงุจ (USD)
            <input type="number" step="0.01" id="balance" value="5000">
          </label>
          <label>ูุณุจุฉ ุงููุฎุงุทุฑุฉ %
            <input type="number" step="0.01" id="riskPct" value="1">
          </label>
          <label>ุนุฏุฏ ููุงุท ุงูููู (Pips)
            <input type="number" step="0.1" id="stopPips" value="20">
          </label>
          <label>ูููุฉ ุงูููุทุฉ ููู ููุช (USD)
            <input type="number" step="0.01" id="pipValue" value="10">
          </label>
          <div class="full">
            <button id="calcBtn" class="primary">ุงุญุณุจ ุญุฌู ุงูุนูุฏ</button>
          </div>
        </div>
        <div id="riskOut" class="result" hidden></div>
      </div>

      <div class="card">
        <h3>๐ ุฅุถุงูุฉ ุตููุฉ ุฅูู ุงูุณุฌู</h3>
        <div class="grid">
          <label>ุงูุฒูุฌ<input id="tPair" placeholder="EURUSD"></label>
          <label>ุงูุงุชุฌุงู
            <select id="tSide"><option>BUY</option><option>SELL</option></select>
          </label>
          <label>ุงูุฏุฎูู<input id="tEntry" type="number" step="0.00001"></label>
          <label>ููู ุงูุฎุณุงุฑุฉ SL<input id="tSL" type="number" step="0.00001"></label>
          <label>ุฌูู ุงูุฑุจุญ TP<input id="tTP" type="number" step="0.00001"></label>
          <label>ุงูููุช<input id="tLot" type="number" step="0.001"></label>
          <label>ุงููุชูุฌุฉ
            <select id="tRes">
              <option value="PENDING">ูุนููุฉ</option>
              <option value="WIN">ุฑุงุจุญุฉ</option>
              <option value="LOSS">ุฎุงุณุฑุฉ</option>
              <option value="BE">ุชุนุงุฏู</option>
            </select>
          </label>
          <label class="full">ููุงุญุธุงุช<input id="tNotes" placeholder="ูุซุงู: ูุณุฑ ุชุฑูุฏ + ุฎุจุฑ CPI"></label>
          <div class="full">
            <button id="saveTrade" class="primary outline">ุญูุธ ุงูุตููุฉ</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Journal -->
    <section id="tab-journal" class="tab">
      <div class="card">
        <h2>๐ ุณุฌู ุงูุตููุงุช</h2>
        <div class="toolbar">
          <button id="btnCsv" class="ghost">ุชุตุฏูุฑ CSV</button>
          <button id="btnReport" class="ghost">ุชูุฑูุฑ PDF</button>
          <button id="btnClear" class="danger">ูุณุญ ุงูุณุฌู</button>
        </div>
        <div class="scroll">
          <table class="journal">
            <thead><tr>
              <th>ุงูุชุงุฑูุฎ</th><th>ุงูุฒูุฌ</th><th>ุงุชุฌุงู</th><th>ุฏุฎูู</th><th>SL</th><th>TP</th><th>ููุช</th><th>ุงููุชูุฌุฉ</th><th>R</th><th>PnL $</th><th>ุญุฐู</th>
            </tr></thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Stats -->
    <section id="tab-stats" class="tab">
      <div class="card">
        <h2>๐ ุงูุฅุญุตุงุฆูุงุช</h2>
        <div class="kpis">
          <div class="kpi"><span id="kTotal">0</span><small>ุฅุฌูุงูู</small></div>
          <div class="kpi"><span id="kWin">0</span><small>ุฑุงุจุญุฉ</small></div>
          <div class="kpi"><span id="kLoss">0</span><small>ุฎุงุณุฑุฉ</small></div>
          <div class="kpi"><span id="kWR">0%</span><small>ูุณุจุฉ ูุฌุงุญ</small></div>
          <div class="kpi"><span id="kNet">$0.00</span><small>ุตุงูู PnL</small></div>
          <div class="kpi"><span id="kAvgR">0.00</span><small>ูุชูุณุท R</small></div>
        </div>
      </div>
      <div class="card">
        <h3>ููุญูู ุงูุฃุฏุงุก (PnL ูุชุฑุงูู)</h3>
        <div class="chart-wrap"><canvas id="equity" width="1000" height="300"></canvas></div>
      </div>
      <div class="card">
        <h3>ุชูุฑูุฑ ุดูุฑู</h3>
        <div class="scroll">
          <table class="journal">
            <thead><tr>
              <th>ุงูุดูุฑ</th><th>ุงูุตููุงุช</th><th>ุฑุงุจุญุฉ</th><th>ุฎุงุณุฑุฉ</th><th>BE</th><th>ูุณุจุฉ ุงููุฌุงุญ</th><th>ุตุงูู $</th><th>ูุชูุณุท R</th>
            </tr></thead>
            <tbody id="tbodyMonth"></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Backup -->
    <section id="tab-backup" class="tab">
      <div class="card">
        <h2>๐พ ูุณุฎ ุงุญุชูุงุทู ูุงุณุชุฑุฌุงุน</h2>
        <div class="grid">
          <div class="full">
            <button id="btnExportJson" class="ghost">ุชุตุฏูุฑ JSON</button>
          </div>
          <label class="full">ุงุณุชุฑุฌุงุน ูู JSON
            <input type="file" id="fileImport" accept="application/json">
          </label>
        </div>
        <p class="muted">ุงูุจูุงูุงุช ุชูุญูุธ ูุญูููุง ูู ุฌูุงุฒู (LocalStorage). ุงุณุชุฎุฏู JSON ูููุณุฎ ุงูุงุญุชูุงุทู ุจูู ุงูุฃุฌูุฒุฉ.</p>
      </div>
    </section>
  </main>

  <footer class="footer">
    ุชู ุงูุชุตููู ูู ูุจู <b>ุงููููุฏุณ ุนุฒุงูุฏูู ุงููุญููู</b> โ Instagram:
    <a href="https://instagram.com/ezaldeen.aldulami" target="_blank">ezaldeen.aldulami</a>
  </footer>

  <script src="./script.js"></script>
  <script>
    // PWA install button
    let deferredPrompt;
    const btnInstall = document.getElementById('btnInstall');
    window.addEventListener('beforeinstallprompt', (e)=>{
      e.preventDefault(); deferredPrompt = e; btnInstall.hidden = false;
    });
    btnInstall?.addEventListener('click', async ()=>{
      btnInstall.hidden = true;
      if(deferredPrompt){ deferredPrompt.prompt(); await deferredPrompt.userChoice; deferredPrompt = null; }
      else alert('Android: ูู ูุงุฆูุฉ โฎ ุงุฎุชุฑ Add to Home screen');
    });

    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js').catch(console.error);
      });
    }
  </script>
</body>
</html>
